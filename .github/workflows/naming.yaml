name: Naming convention for pull request
on:
  pull_request:
    branches-ignore:
      - 'master'
      - 'development'
      - 'staging'
    types: [edited, reopened, ready_for_review, synchronize, opened]

jobs:
  checker:
    runs-on: ubuntu-latest
    steps:
      - name: Validate branch
        env:
          BRANCH: ${{ github.event.pull_request.head.ref }}
        run: |
            if [[ "$BRANCH" =~ ^(feat|fix|hotfix|chore)\/[[:alnum:]_@.-]+$ ]]
            then
              echo "Pull request branch name is following the convention" && exit 0
            else
              echo "Pull request branch name is not following the convention" && exit 1
            fi
      - name: Validate title
        env:
          TITLE: ${{ github.event.pull_request.title }}
        run: |
            if [[ "$TITLE" =~ ^(\[[^\]]*\])+[[:space:]](Feat|Fix|Hotfix|Chore):[[:space:]][[:alnum:][:space:]]+$ ]]
            then
              echo "Pull request title is following the convention" && exit 0
            else
              echo "Pull request title is not following the convention" && exit 1
            fi
